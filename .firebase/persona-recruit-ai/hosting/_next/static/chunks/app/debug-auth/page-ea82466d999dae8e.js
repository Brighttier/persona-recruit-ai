(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3759],{47765:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>h});var n=r(95155),i=r(40283),a=r(66695),l=r(30285),c=r(35695),o=r(12115),t=r(22201),d=r(50172);function h(){let{user:e,loading:s,signOut:r}=(0,i.A)(),h=(0,c.useRouter)(),[x,u]=(0,o.useState)(null),[j,m]=(0,o.useState)(!1);(0,o.useEffect)(()=>{!async function(){t.j2.currentUser&&u((await t.j2.currentUser.getIdTokenResult()).claims)}()},[e]);let p=async()=>{m(!0);try{if(t.j2.currentUser){let e=await t.j2.currentUser.getIdTokenResult(!0);u(e.claims),window.location.reload()}}catch(e){console.error("Error refreshing token:",e)}finally{m(!1)}};return s?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)(d.A,{className:"h-8 w-8 animate-spin"})}):(0,n.jsx)("div",{className:"min-h-screen p-8 bg-gray-50",children:(0,n.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Auth Debug Information"}),(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsx)(a.ZB,{children:"Current User Info"})}),(0,n.jsx)(a.Wu,{children:e?(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Email:"})," ",e.email]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"UID:"})," ",e.uid]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Display Name:"})," ",e.displayName||"Not set"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Full Name:"})," ",e.fullName||"Not set"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Role from Context:"})," ",(0,n.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:e.role})]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Company ID:"})," ",e.companyId||"Not set"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Email Verified:"})," ",e.emailVerified?"Yes":"No"]})]}):(0,n.jsx)("p",{children:"No user logged in"})})]}),(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsx)(a.ZB,{children:"Firebase Token Claims"})}),(0,n.jsx)(a.Wu,{children:x?(0,n.jsx)("pre",{className:"bg-gray-100 p-4 rounded overflow-auto",children:JSON.stringify(x,null,2)}):(0,n.jsx)("p",{children:"No token claims available"})})]}),(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsx)(a.ZB,{children:"Quick Actions"})}),(0,n.jsxs)(a.Wu,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,n.jsx)(l.$,{onClick:()=>h.push("/admin/dashboard"),variant:"outline",children:"Go to Admin Dashboard"}),(0,n.jsx)(l.$,{onClick:()=>h.push("/candidates/dashboard"),variant:"outline",children:"Go to Candidate Dashboard"}),(0,n.jsx)(l.$,{onClick:()=>h.push("/company/dashboard"),variant:"outline",children:"Go to Company Dashboard"})]}),(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsx)(l.$,{onClick:p,disabled:j,children:j?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):"Force Refresh Token"}),(0,n.jsx)(l.$,{onClick:r,variant:"destructive",children:"Sign Out"})]})]})]}),(0,n.jsxs)(a.Zp,{className:"border-orange-200 bg-orange-50",children:[(0,n.jsx)(a.aR,{children:(0,n.jsx)(a.ZB,{className:"text-orange-800",children:"Troubleshooting Tips"})}),(0,n.jsxs)(a.Wu,{className:"text-sm space-y-2 text-orange-700",children:[(0,n.jsx)("p",{children:"1. If role shows as 'candidate' but should be 'super_admin', the custom claims may not be set properly in Firebase."}),(0,n.jsx)("p",{children:"2. Check Firebase Console → Authentication → Users → Click on user → Custom Claims"}),(0,n.jsx)("p",{children:"3. You may need to set custom claims via Firebase Admin SDK or Cloud Functions"}),(0,n.jsx)("p",{children:"4. After setting claims, force refresh the token using the button above"}),(0,n.jsx)("p",{children:"5. Check Firestore → users collection → your user document for the role field"})]})]})]})})}},52280:(e,s,r)=>{Promise.resolve().then(r.bind(r,47765))}},e=>{var s=s=>e(e.s=s);e.O(0,[4121,2076,7358],()=>s(52280)),_N_E=e.O()}]);