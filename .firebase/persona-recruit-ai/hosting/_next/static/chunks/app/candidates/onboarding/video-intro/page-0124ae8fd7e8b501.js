(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9112],{450:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var r=t(95155),a=t(12115),i=t(35695),n=t(66695),c=t(30285),l=t(24944),d=t(55365),o=t(87481),u=t(45481),m=t(8376),x=t(50594),h=t(11133),j=t(6273),p=t(7149),f=t(67933),g=t(53764),v=t(8531),y=t(50172),b=t(16923);function w(){let e=(0,i.useRouter)(),{toast:s}=(0,o.dj)(),t=(0,a.useRef)(null),w=(0,a.useRef)(null),N=(0,a.useRef)(null),k=(0,a.useRef)([]),[R,S]=(0,a.useState)(!1),[A,C]=(0,a.useState)(!1),[T,E]=(0,a.useState)(null),[F,P]=(0,a.useState)(0),[O,$]=(0,a.useState)(0),[z,U]=(0,a.useState)(!1),[_,I]=(0,a.useState)("pending"),[M,q]=(0,a.useState)(!0);(0,a.useEffect)(()=>(B(),()=>{Y()}),[]),(0,a.useEffect)(()=>{let e;return O>0?e=setInterval(()=>{$(e=>e-1)},1e3):0===O&&R&&F<10&&(e=setInterval(()=>{P(e=>e>=9.9?(L(),10):e+.1)},100)),()=>clearInterval(e)},[O,R,F]);let B=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"user"},audio:!0});N.current=e,t.current&&(t.current.srcObject=e),I("granted")}catch(e){console.error("Camera permission denied:",e),I("denied"),s({title:"Camera Access Required",description:"Please allow camera and microphone access to record your introduction.",variant:"destructive"})}},Y=()=>{N.current&&(N.current.getTracks().forEach(e=>e.stop()),N.current=null)},D=async()=>{if(!N.current)return;k.current=[],E(null),P(0),$(3),C(!1);let e={mimeType:"video/webm;codecs=vp8,opus"};MediaRecorder.isTypeSupported(e.mimeType)||(e.mimeType="video/webm");try{let s=new MediaRecorder(N.current,e);w.current=s,s.ondataavailable=e=>{e.data.size>0&&k.current.push(e.data)},s.onstop=()=>{let s=new Blob(k.current,{type:e.mimeType});E(s),C(!0),t.current&&(t.current.srcObject=null,t.current.src=URL.createObjectURL(s))},setTimeout(()=>{s.start(),S(!0)},3e3)}catch(e){console.error("Failed to start recording:",e),s({title:"Recording Failed",description:"Failed to start recording. Please try again.",variant:"destructive"})}},L=()=>{w.current&&"recording"===w.current.state&&(w.current.stop(),S(!1))},Z=async()=>{if(T)try{U(!0);let t=new FormData;t.append("video",T,"intro.webm"),t.append("duration",F.toString());let r=await fetch("/api/candidates/video-intro",{method:"POST",body:t});if(!r.ok){let e=await r.json();throw Error(e.error||"Upload failed")}await r.json(),s({title:"\uD83C\uDF89 Profile Complete!",description:"Your video introduction has been uploaded successfully."}),e.push("/candidates/dashboard")}catch(e){s({title:"Upload Failed",description:e instanceof Error?e.message:"Please try again.",variant:"destructive"})}finally{U(!1)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:(0,r.jsxs)(n.Zp,{className:"w-full max-w-3xl",children:[(0,r.jsxs)(n.aR,{className:"text-center",children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.A,{className:"h-12 w-12 text-primary"}),A&&T&&(0,r.jsx)(m.A,{className:"h-5 w-5 text-green-500 absolute -bottom-1 -right-1"})]})}),(0,r.jsx)(n.ZB,{className:"text-2xl",children:"Record Your Introduction"}),(0,r.jsx)(n.BT,{children:"Record a quick 10-second video to introduce yourself to potential employers"})]}),(0,r.jsxs)(n.Wu,{className:"space-y-6",children:[(0,r.jsxs)(d.Fc,{children:[(0,r.jsx)(x.A,{className:"h-4 w-4"}),(0,r.jsxs)(d.TN,{children:[(0,r.jsx)("strong",{children:"Tips for a great introduction:"}),(0,r.jsxs)("ul",{className:"list-disc ml-5 mt-2 space-y-1 text-sm",children:[(0,r.jsx)("li",{children:"State your name and current role"}),(0,r.jsx)("li",{children:"Mention your key skills or expertise"}),(0,r.jsx)("li",{children:"Express what you're looking for"}),(0,r.jsx)("li",{children:"Smile and maintain eye contact"}),(0,r.jsx)("li",{children:"Ensure good lighting and clear audio"})]})]})]}),(0,r.jsx)("div",{className:"relative aspect-video bg-black rounded-lg overflow-hidden",children:"denied"===_?(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-muted",children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)(h.A,{className:"h-12 w-12 text-muted-foreground mx-auto"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Camera access is required to record your introduction"}),(0,r.jsx)(c.$,{onClick:B,children:"Grant Camera Access"})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("video",{ref:t,autoPlay:!0,muted:!A,playsInline:!0,className:"w-full h-full object-cover"}),O>0&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-white text-6xl font-bold animate-pulse",children:O})}),R&&0===O&&(0,r.jsxs)("div",{className:"absolute top-4 left-4 flex items-center gap-2 bg-red-600 text-white px-3 py-1.5 rounded-full",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Recording"})]}),!A&&(0,r.jsx)(c.$,{variant:"secondary",size:"icon",className:"absolute bottom-4 right-4",onClick:()=>{N.current&&(N.current.getAudioTracks().forEach(e=>{e.enabled=!M}),q(!M))},children:M?(0,r.jsx)(j.A,{className:"h-4 w-4"}):(0,r.jsx)(p.A,{className:"h-4 w-4"})})]})}),(R||F>0)&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[(0,r.jsx)("span",{children:"Recording Progress"}),(0,r.jsxs)("span",{children:[F.toFixed(1),"s / ",10,"s"]})]}),(0,r.jsx)(l.k,{value:F/10*100})]}),(0,r.jsxs)("div",{className:"flex gap-3 justify-center",children:[!R&&!A&&(0,r.jsxs)(c.$,{onClick:D,size:"lg",disabled:"granted"!==_,children:[(0,r.jsx)(f.A,{className:"h-5 w-5 mr-2"}),"Start Recording"]}),R&&0===O&&(0,r.jsxs)(c.$,{onClick:L,size:"lg",variant:"destructive",children:[(0,r.jsx)(g.A,{className:"h-5 w-5 mr-2"}),"Stop Recording"]}),A&&T&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.$,{onClick:()=>{E(null),P(0),C(!1),$(0),t.current&&N.current&&(t.current.srcObject=N.current,t.current.src="")},size:"lg",variant:"outline",children:[(0,r.jsx)(v.A,{className:"h-5 w-5 mr-2"}),"Re-record"]}),(0,r.jsx)(c.$,{onClick:Z,size:"lg",disabled:z,children:z?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.A,{className:"h-5 w-5 mr-2 animate-spin"}),"Uploading..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.A,{className:"h-5 w-5 mr-2"}),"Save & Continue"]})})]})]}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(c.$,{variant:"link",onClick:()=>{confirm("Are you sure you want to skip the video introduction? You can always add it later from your profile.")&&e.push("/candidates/dashboard")},className:"text-muted-foreground",children:"Skip for now (you can add it later)"})})]})]})})}},73883:(e,s,t)=>{Promise.resolve().then(t.bind(t,450))}},e=>{var s=s=>e(e.s=s);e.O(0,[4121,2076,7358],()=>s(73883)),_N_E=e.O()}]);