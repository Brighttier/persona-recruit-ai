(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4700],{129:(e,s,a)=>{Promise.resolve().then(a.bind(a,64622))},64622:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>b});var t=a(95155),r=a(12115),n=a(35695),l=a(30285),c=a(66695),i=a(62523),d=a(85057),x=a(55365),o=a(50172),m=a(11133),h=a(12543),u=a(8376),j=a(31573),p=a(4607),g=a(17607),f=a(6874),w=a.n(f);function N(){let e=(0,n.useSearchParams)(),s=(0,n.useRouter)(),a=e.get("token"),[f,N]=(0,r.useState)(""),[b,v]=(0,r.useState)(""),[y,k]=(0,r.useState)(!1),[C,P]=(0,r.useState)(!1),[A,S]=(0,r.useState)(!1),[R,T]=(0,r.useState)(!0),[Z,B]=(0,r.useState)(!1),[F,O]=(0,r.useState)(""),[$,L]=(0,r.useState)(""),[_,q]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{if(!a){L("Invalid reset link. Please request a new password reset."),T(!1);return}try{let e=await fetch("/api/auth/forgot-password?token=".concat(a)),s=await e.json();e.ok?(B(!0),O(s.email)):L(s.error||"Invalid or expired reset token.")}catch(e){L("Network error. Please check your connection and try again.")}finally{T(!1)}})()},[a]);let E=(e=>{let s=/[A-Z]/.test(e),a=/[a-z]/.test(e),t=/\d/.test(e),r=/[!@#$%^&*(),.?":{}|<>]/.test(e);return{length:e.length>=8,upperCase:s,lowerCase:a,numbers:t,specialChar:r,isValid:e.length>=8&&s&&a&&t&&r}})(f),W=f===b,V=async e=>{if(e.preventDefault(),!E.isValid)return void L("Password does not meet security requirements.");if(!W)return void L("Passwords do not match.");S(!0),L("");try{let e=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,password:f})}),t=await e.json();e.ok?(q(!0),setTimeout(()=>{s.push("/login")},3e3)):L(t.error||"Failed to reset password. Please try again.")}catch(e){L("Network error. Please check your connection and try again.")}finally{S(!1)}};return R?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 px-4",children:(0,t.jsx)(c.Zp,{className:"w-full max-w-md",children:(0,t.jsx)(c.Wu,{className:"flex items-center justify-center p-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(o.A,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Validating reset link..."})]})})})}):Z?_?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 px-4",children:(0,t.jsxs)(c.Zp,{className:"w-full max-w-md",children:[(0,t.jsxs)(c.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(u.A,{className:"h-6 w-6 text-green-600"})}),(0,t.jsx)(c.ZB,{className:"text-2xl font-bold",children:"Password Reset Successfully!"}),(0,t.jsx)(c.BT,{children:"Your password has been updated"})]}),(0,t.jsxs)(c.Wu,{className:"space-y-4",children:[(0,t.jsxs)(x.Fc,{className:"border-green-200 bg-green-50 text-green-800",children:[(0,t.jsx)(u.A,{className:"h-4 w-4"}),(0,t.jsx)(x.TN,{children:"Your password has been successfully reset. You can now log in with your new password."})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Redirecting to login page in a few seconds..."}),(0,t.jsx)(w(),{href:"/login",children:(0,t.jsx)(l.$,{className:"w-full",children:"Continue to Login"})})]})]})]})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 px-4",children:(0,t.jsxs)(c.Zp,{className:"w-full max-w-md",children:[(0,t.jsxs)(c.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(j.A,{className:"h-6 w-6 text-blue-600"})}),(0,t.jsx)(c.ZB,{className:"text-2xl font-bold",children:"Reset Your Password"}),(0,t.jsxs)(c.BT,{children:["Create a new password for ",F]})]}),(0,t.jsx)(c.Wu,{children:(0,t.jsxs)("form",{onSubmit:V,className:"space-y-4",children:[$&&(0,t.jsxs)(x.Fc,{variant:"destructive",children:[(0,t.jsx)(m.A,{className:"h-4 w-4"}),(0,t.jsx)(x.TN,{children:$})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.J,{htmlFor:"password",children:"New Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(i.p,{id:"password",type:y?"text":"password",placeholder:"Enter your new password",value:f,onChange:e=>N(e.target.value),required:!0,disabled:A,className:"h-11 pr-10"}),(0,t.jsx)(l.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>k(!y),disabled:A,children:y?(0,t.jsx)(p.A,{className:"h-4 w-4 text-gray-500"}):(0,t.jsx)(g.A,{className:"h-4 w-4 text-gray-500"})})]}),f&&(0,t.jsxs)("div",{className:"text-xs space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 ".concat(E.length?"text-green-600":"text-red-600"),children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(E.length?"bg-green-600":"bg-red-600")}),(0,t.jsx)("span",{children:"At least 8 characters"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 ".concat(E.upperCase?"text-green-600":"text-red-600"),children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(E.upperCase?"bg-green-600":"bg-red-600")}),(0,t.jsx)("span",{children:"One uppercase letter"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 ".concat(E.lowerCase?"text-green-600":"text-red-600"),children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(E.lowerCase?"bg-green-600":"bg-red-600")}),(0,t.jsx)("span",{children:"One lowercase letter"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 ".concat(E.numbers?"text-green-600":"text-red-600"),children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(E.numbers?"bg-green-600":"bg-red-600")}),(0,t.jsx)("span",{children:"One number"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 ".concat(E.specialChar?"text-green-600":"text-red-600"),children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(E.specialChar?"bg-green-600":"bg-red-600")}),(0,t.jsx)("span",{children:"One special character"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.J,{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(i.p,{id:"confirmPassword",type:C?"text":"password",placeholder:"Confirm your new password",value:b,onChange:e=>v(e.target.value),required:!0,disabled:A,className:"h-11 pr-10"}),(0,t.jsx)(l.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>P(!C),disabled:A,children:C?(0,t.jsx)(p.A,{className:"h-4 w-4 text-gray-500"}):(0,t.jsx)(g.A,{className:"h-4 w-4 text-gray-500"})})]}),b&&(0,t.jsx)("div",{className:"text-xs",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2 ".concat(W?"text-green-600":"text-red-600"),children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(W?"bg-green-600":"bg-red-600")}),(0,t.jsx)("span",{children:W?"Passwords match":"Passwords do not match"})]})})]}),(0,t.jsx)(l.$,{type:"submit",className:"w-full h-11",disabled:A||!E.isValid||!W,children:A?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Resetting Password..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Reset Password"]})}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(w(),{href:"/login",children:(0,t.jsxs)(l.$,{variant:"ghost",className:"text-sm",children:[(0,t.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Back to Login"]})})})]})})]})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 px-4",children:(0,t.jsxs)(c.Zp,{className:"w-full max-w-md",children:[(0,t.jsxs)(c.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(m.A,{className:"h-6 w-6 text-red-600"})}),(0,t.jsx)(c.ZB,{className:"text-2xl font-bold",children:"Invalid Reset Link"}),(0,t.jsx)(c.BT,{children:"This password reset link is invalid or has expired"})]}),(0,t.jsxs)(c.Wu,{className:"space-y-4",children:[(0,t.jsxs)(x.Fc,{variant:"destructive",children:[(0,t.jsx)(m.A,{className:"h-4 w-4"}),(0,t.jsx)(x.TN,{children:$})]}),(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Password reset links expire after 15 minutes for security."}),(0,t.jsx)(w(),{href:"/forgot-password",children:(0,t.jsx)(l.$,{className:"w-full",children:"Request New Reset Link"})}),(0,t.jsx)(w(),{href:"/login",children:(0,t.jsxs)(l.$,{variant:"ghost",className:"w-full",children:[(0,t.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Back to Login"]})})]})]})]})})}function b(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 px-4",children:(0,t.jsx)(c.Zp,{className:"w-full max-w-md",children:(0,t.jsx)(c.Wu,{className:"flex items-center justify-center p-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(o.A,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})})})}),children:(0,t.jsx)(N,{})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[4121,2076,7358],()=>s(129)),_N_E=e.O()}]);