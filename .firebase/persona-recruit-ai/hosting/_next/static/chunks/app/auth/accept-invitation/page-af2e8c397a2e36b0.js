(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1078],{2776:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>k});var t=a(95155),r=a(12115),n=a(35695),i=a(62177),c=a(90221),l=a(71153),o=a(66695),d=a(30285),m=a(62523),u=a(17759),x=a(26126),h=a(87481),j=a(45731),p=a(91721),f=a(8376),w=a(50172),N=a(24371),v=a(86950),y=a(19637);let g=l.Ik({password:l.Yj().min(8,"Password must be at least 8 characters"),confirmPassword:l.Yj().min(8,"Please confirm your password")}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function b(){let e=(0,n.useSearchParams)(),s=(0,n.useRouter)(),{toast:a}=(0,h.dj)(),[l,b]=(0,r.useState)(!0),[k,P]=(0,r.useState)(!1),[A,S]=(0,r.useState)(null),[C,I]=(0,r.useState)(null),E=null==e?void 0:e.get("token"),_=(0,i.mN)({resolver:(0,c.u)(g),defaultValues:{password:"",confirmPassword:""}});(0,r.useEffect)(()=>{if(!E){I("Invalid invitation link. Please check your email for the correct link."),b(!1);return}(async()=>{try{b(!0);let e=await fetch("/api/auth/accept-invitation?token=".concat(E));if(!e.ok){let s=await e.json();throw Error(s.error||"Invalid invitation")}let s=await e.json();S(s.data.invitation),I(null)}catch(e){I(e instanceof Error?e.message:"Failed to validate invitation"),S(null)}finally{b(!1)}})()},[E]);let B=async e=>{if(E)try{P(!0);let t=await fetch("/api/auth/accept-invitation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:E,password:e.password,confirmPassword:e.confirmPassword})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to accept invitation")}let r=await t.json();localStorage.setItem("auth-token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data.user)),a({title:"\uD83C\uDF89 Welcome to the team!",description:"Your account has been created successfully."});let n=r.data.user,i="company_admin"===n.role?"/company/dashboard":"recruiter"===n.role?"/recruiter/dashboard":"/interviewer/dashboard";s.push(i)}catch(e){a({title:"Failed to Accept Invitation",description:e instanceof Error?e.message:"Please try again.",variant:"destructive"})}finally{P(!1)}};return l?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,t.jsx)(o.Zp,{className:"w-full max-w-md",children:(0,t.jsx)(o.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,t.jsx)(w.A,{className:"h-5 w-5 animate-spin"}),(0,t.jsx)("span",{children:"Validating invitation..."})]})})})}):C?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,t.jsxs)(o.Zp,{className:"w-full max-w-md",children:[(0,t.jsxs)(o.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)(N.A,{className:"h-12 w-12 text-destructive"})}),(0,t.jsx)(o.ZB,{className:"text-xl",children:"Invalid Invitation"}),(0,t.jsx)(o.BT,{children:C})]}),(0,t.jsx)(o.Wu,{children:(0,t.jsx)(d.$,{onClick:()=>s.push("/auth"),className:"w-full",children:"Go to Login"})})]})}):A?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:(0,t.jsxs)(o.Zp,{className:"w-full max-w-md",children:[(0,t.jsxs)(o.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)(v.A,{className:"h-12 w-12 text-primary"})}),(0,t.jsx)(o.ZB,{className:"text-2xl",children:"Accept Invitation"}),(0,t.jsx)(o.BT,{children:"Complete your account setup to join the team"})]}),(0,t.jsxs)(o.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4 p-4 bg-muted/50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:A.email})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("span",{className:"text-sm",children:[A.firstName," ",A.lastName]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm",children:A.companyName})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(e=>{switch(e){case"company_admin":return(0,t.jsx)(j.A,{className:"h-4 w-4"});case"recruiter":default:return(0,t.jsx)(p.A,{className:"h-4 w-4"});case"interviewer":return(0,t.jsx)(f.A,{className:"h-4 w-4"})}})(A.role),(0,t.jsx)(x.E,{variant:(e=>{switch(e){case"company_admin":return"default";case"recruiter":default:return"secondary";case"interviewer":return"outline"}})(A.role),className:"text-xs",children:A.role.replace("_"," ")}),A.department&&(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["â€¢ ",A.department]})]}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Expires: ",new Date(A.expiresAt).toLocaleDateString()]})]}),(0,t.jsx)(u.lV,{..._,children:(0,t.jsxs)("form",{onSubmit:_.handleSubmit(B),className:"space-y-4",children:[(0,t.jsx)(u.zB,{control:_.control,name:"password",render:e=>{let{field:s}=e;return(0,t.jsxs)(u.eI,{children:[(0,t.jsx)(u.lR,{children:"Create Password"}),(0,t.jsx)(u.MJ,{children:(0,t.jsx)(m.p,{type:"password",placeholder:"Enter your password",...s})}),(0,t.jsx)(u.C5,{})]})}}),(0,t.jsx)(u.zB,{control:_.control,name:"confirmPassword",render:e=>{let{field:s}=e;return(0,t.jsxs)(u.eI,{children:[(0,t.jsx)(u.lR,{children:"Confirm Password"}),(0,t.jsx)(u.MJ,{children:(0,t.jsx)(m.p,{type:"password",placeholder:"Confirm your password",...s})}),(0,t.jsx)(u.C5,{})]})}}),(0,t.jsx)(d.$,{type:"submit",className:"w-full",disabled:k,children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating Account..."]}):"Accept Invitation & Create Account"})]})}),(0,t.jsx)("div",{className:"text-center text-xs text-muted-foreground",children:"By accepting this invitation, you agree to our Terms of Service and Privacy Policy."})]})]})}):null}function k(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(w.A,{className:"h-8 w-8 animate-spin"})}),children:(0,t.jsx)(b,{})})}},93793:(e,s,a)=>{Promise.resolve().then(a.bind(a,2776))}},e=>{var s=s=>e(e.s=s);e.O(0,[4121,2076,7358],()=>s(93793)),_N_E=e.O()}]);